# å·´è’‚å…‹å›¾æ¡ˆè¯†åˆ«æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://kdocs.cn/l/cszuIiCKVNis)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

å·´è’‚å…‹ï¼ˆBatikï¼‰ä½œä¸ºä¸€ç§ç‹¬ç‰¹çš„ä¼ ç»Ÿæ‰‹å·¥è‰ºï¼Œæºäºå°åº¦å°¼è¥¿äºšï¼Œå…·æœ‰æ·±åšçš„æ–‡åŒ–åº•è•´å’Œä¸°å¯Œçš„è‰ºæœ¯è¡¨ç°å½¢å¼ã€‚å…¶å›¾æ¡ˆå’Œè‰²å½©ä¸ä»…ä½“ç°äº†å½“åœ°çš„è‡ªç„¶é£è²Œå’Œæ°‘æ—ç‰¹è‰²ï¼Œæ›´æ‰¿è½½ç€å†å²ã€å®—æ•™å’Œç¤¾ä¼šçš„å¤šé‡æ„ä¹‰ã€‚éšç€å…¨çƒåŒ–çš„æ¨è¿›ï¼Œå·´è’‚å…‹é€æ¸å—åˆ°å›½é™…ç¤¾ä¼šçš„å…³æ³¨ï¼Œæˆä¸ºäº†æ–‡åŒ–äº¤æµçš„é‡è¦è½½ä½“ã€‚ç„¶è€Œï¼Œå·´è’‚å…‹å›¾æ¡ˆçš„å¤šæ ·æ€§å’Œå¤æ‚æ€§ä½¿å¾—å…¶è¯†åˆ«å’Œåˆ†ç±»é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯åœ¨æ•°å­—åŒ–å’Œè‡ªåŠ¨åŒ–çš„èƒŒæ™¯ä¸‹ï¼Œå¦‚ä½•é«˜æ•ˆã€å‡†ç¡®åœ°è¯†åˆ«ä¸åŒç±»å‹çš„å·´è’‚å…‹å›¾æ¡ˆï¼Œæˆä¸ºäº†äºŸå¾…è§£å†³çš„é—®é¢˜ã€‚

åœ¨è¿™ä¸€èƒŒæ™¯ä¸‹ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„å·´è’‚å…‹å›¾æ¡ˆè¯†åˆ«ç³»ç»Ÿåº”è¿è€Œç”Ÿã€‚YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹ä»¥å…¶å¿«é€Ÿçš„æ£€æµ‹é€Ÿåº¦å’Œè¾ƒé«˜çš„å‡†ç¡®ç‡ï¼Œå¹¿æ³›åº”ç”¨äºç‰©ä½“æ£€æµ‹é¢†åŸŸã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†æ¨¡å‹çš„æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤æ‚èƒŒæ™¯å’Œå¤šç±»åˆ«ç‰©ä½“æ£€æµ‹æ–¹é¢ï¼Œå±•ç°å‡ºæ›´å¼ºçš„é€‚åº”æ€§å’Œé²æ£’æ€§ã€‚å› æ­¤ï¼Œåˆ©ç”¨YOLOv8çš„ä¼˜åŠ¿ï¼Œæ„å»ºä¸€ä¸ªä¸“é—¨é’ˆå¯¹å·´è’‚å…‹å›¾æ¡ˆçš„è¯†åˆ«ç³»ç»Ÿï¼Œä¸ä»…èƒ½å¤Ÿæå‡è¯†åˆ«çš„æ•ˆç‡ï¼Œè¿˜èƒ½ä¸ºå·´è’‚å…‹æ–‡åŒ–çš„ä¿æŠ¤å’Œä¼ æ‰¿æä¾›æŠ€æœ¯æ”¯æŒã€‚

æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«1900å¼ å›¾åƒï¼Œæ¶µç›–15ç§ä¸åŒç±»åˆ«çš„å·´è’‚å…‹å›¾æ¡ˆã€‚è¿™äº›ç±»åˆ«åŒ…æ‹¬å·´è’‚å…‹-å·´å˜ï¼ˆBatik-Baliï¼‰ã€å·´è’‚å…‹-è´å¡”ç»´ï¼ˆBatik-Betawiï¼‰ã€å·´è’‚å…‹-æµ¸æŸ“ï¼ˆBatik-Celupï¼‰ã€å·´è’‚å…‹-é¸Ÿï¼ˆBatik-Cendrawasihï¼‰ã€å·´è’‚å…‹-è¾¾é›…å…‹ï¼ˆBatik-Dayakï¼‰ç­‰ï¼Œå……åˆ†ä½“ç°äº†å·´è’‚å…‹çš„å¤šæ ·æ€§å’Œä¸°å¯Œæ€§ã€‚é€šè¿‡å¯¹è¿™äº›å›¾æ¡ˆçš„ç³»ç»Ÿæ€§åˆ†æä¸è¯†åˆ«ï¼Œä¸ä»…èƒ½å¤Ÿå¸®åŠ©ç ”ç©¶è€…æ›´å¥½åœ°ç†è§£å·´è’‚å…‹çš„è‰ºæœ¯ç‰¹å¾ï¼Œè¿˜èƒ½ä¸ºç›¸å…³äº§ä¸šæä¾›æ•°æ®æ”¯æŒï¼Œæ¨åŠ¨å·´è’‚å…‹æ–‡åŒ–çš„æ•°å­—åŒ–è½¬å‹ã€‚

æ­¤å¤–ï¼Œå·´è’‚å…‹å›¾æ¡ˆçš„è¯†åˆ«ç³»ç»Ÿåœ¨å®é™…åº”ç”¨ä¸­å…·æœ‰å¹¿æ³›çš„æ„ä¹‰ã€‚é¦–å…ˆï¼Œå®ƒå¯ä»¥ä¸ºè®¾è®¡å¸ˆæä¾›çµæ„Ÿï¼Œå¸®åŠ©ä»–ä»¬åœ¨åˆ›ä½œä¸­èå…¥ä¼ ç»Ÿå…ƒç´ ï¼Œä¿ƒè¿›ä¼ ç»Ÿä¸ç°ä»£çš„ç»“åˆã€‚å…¶æ¬¡ï¼Œéšç€ç”µå­å•†åŠ¡çš„å‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„å·´è’‚å…‹äº§å“é€šè¿‡ç½‘ç»œå¹³å°è¿›è¡Œé”€å”®ï¼Œå‡†ç¡®çš„å›¾æ¡ˆè¯†åˆ«èƒ½å¤Ÿæå‡æ¶ˆè´¹è€…çš„è´­ç‰©ä½“éªŒï¼Œå¸®åŠ©ä»–ä»¬å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€çš„äº§å“ã€‚æœ€åï¼Œå·´è’‚å…‹ä½œä¸ºä¸€ç§éç‰©è´¨æ–‡åŒ–é—äº§ï¼Œå…¶ä¿æŠ¤å’Œä¼ æ‰¿äºŸéœ€å€ŸåŠ©ç°ä»£ç§‘æŠ€æ‰‹æ®µã€‚é€šè¿‡å»ºç«‹é«˜æ•ˆçš„è¯†åˆ«ç³»ç»Ÿï¼Œå¯ä»¥ä¸ºå·´è’‚å…‹çš„æ•°å­—åŒ–æ¡£æ¡ˆå»ºè®¾æä¾›åŸºç¡€ï¼Œä¿ƒè¿›å…¶åœ¨å…¨çƒèŒƒå›´å†…çš„ä¼ æ’­ä¸å‘å±•ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„å·´è’‚å…‹å›¾æ¡ˆè¯†åˆ«ç³»ç»Ÿä¸ä»…åœ¨æŠ€æœ¯ä¸Šå…·æœ‰åˆ›æ–°æ€§ï¼Œæ›´åœ¨æ–‡åŒ–ä¼ æ‰¿å’Œäº§ä¸šå‘å±•æ–¹é¢å…·æœ‰é‡è¦çš„ç°å®æ„ä¹‰ã€‚é€šè¿‡æœ¬ç ”ç©¶çš„å¼€å±•ï¼ŒæœŸæœ›èƒ½å¤Ÿä¸ºå·´è’‚å…‹çš„ä¿æŠ¤ä¸æ¨å¹¿è´¡çŒ®ä¸€ä»½åŠ›é‡ï¼ŒåŒæ—¶æ¨åŠ¨è®¡ç®—æœºè§†è§‰æŠ€æœ¯åœ¨ä¼ ç»Ÿæ–‡åŒ–é¢†åŸŸçš„åº”ç”¨ä¸å‘å±•ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1eGtBe4ELx/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 15
names: ['Batik-Bali', 'Batik-Betawi', 'Batik-Celup', 'Batik-Cendrawasih', 'Batik-Dayak', 'Batik-Geblek-Renteng', 'Batik-Insang', 'Batik-Kawung', 'Batik-Lasem', 'Batik-Megamendung', 'Batik-Pala', 'Batik-Parang', 'Batik-Poleng', 'Batik-Sekar-Jagad', 'Batik-Tambal']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†åä¸ºâ€œMotif Batikâ€çš„æ•°æ®é›†ï¼Œä»¥æ”¹è¿›YOLOv8æ¨¡å‹åœ¨å·´è’‚å…‹å›¾æ¡ˆè¯†åˆ«ç³»ç»Ÿä¸­çš„æ€§èƒ½ã€‚å·´è’‚å…‹ä½œä¸ºä¸€ç§ä¼ ç»Ÿçš„å°æŸ“è‰ºæœ¯ï¼Œæ‰¿è½½ç€ä¸°å¯Œçš„æ–‡åŒ–å†…æ¶µå’Œå†å²èƒŒæ™¯ï¼Œå…¶å›¾æ¡ˆçš„å¤šæ ·æ€§å’Œå¤æ‚æ€§ä¸ºè®¡ç®—æœºè§†è§‰é¢†åŸŸçš„ç ”ç©¶æä¾›äº†æå…·æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ã€‚ä¸ºäº†æœ‰æ•ˆåœ°è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†åŒ…å«äº†15ä¸ªä¸åŒçš„å·´è’‚å…‹å›¾æ¡ˆç±»åˆ«ï¼Œæ¶µç›–äº†å¹¿æ³›çš„é£æ ¼å’Œè®¾è®¡å…ƒç´ ã€‚

â€œMotif Batikâ€æ•°æ®é›†çš„ç±»åˆ«åŒ…æ‹¬ï¼šBatik-Baliã€Batik-Betawiã€Batik-Celupã€Batik-Cendrawasihã€Batik-Dayakã€Batik-Geblek-Rentengã€Batik-Insangã€Batik-Kawungã€Batik-Lasemã€Batik-Megamendungã€Batik-Palaã€Batik-Parangã€Batik-Polengã€Batik-Sekar-Jagadå’ŒBatik-Tambalã€‚è¿™äº›ç±»åˆ«ä¸ä»…åæ˜ äº†å·´è’‚å…‹å›¾æ¡ˆçš„åœ°åŸŸç‰¹å¾ï¼Œè¿˜å±•ç¤ºäº†ä¸åŒæ–‡åŒ–èƒŒæ™¯ä¸‹çš„è‰ºæœ¯è¡¨ç°å½¢å¼ã€‚ä¾‹å¦‚ï¼ŒBatik-Baliä»¥å…¶é²œè‰³çš„è‰²å½©å’Œå¤æ‚çš„å›¾æ¡ˆè€Œé—»åï¼Œå¸¸å¸¸ä¸å·´å˜å²›çš„è‡ªç„¶æ™¯è§‚å’Œå®—æ•™ä»ªå¼ç›¸ç»“åˆï¼›è€ŒBatik-Parangåˆ™æ˜¯å°å°¼ä¼ ç»Ÿå›¾æ¡ˆä¸­æœ€å…·ä»£è¡¨æ€§çš„ä¹‹ä¸€ï¼Œè±¡å¾ç€åŠ›é‡å’ŒåšéŸ§ã€‚

åœ¨æ•°æ®é›†çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ³¨é‡å›¾åƒçš„å¤šæ ·æ€§å’Œä»£è¡¨æ€§ï¼Œç¡®ä¿æ¯ä¸ªç±»åˆ«éƒ½åŒ…å«è¶³å¤Ÿçš„æ ·æœ¬ï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ åˆ°ä¸åŒå›¾æ¡ˆçš„ç‰¹å¾ã€‚æ¯ä¸ªç±»åˆ«çš„å›¾åƒéƒ½ç»è¿‡ç²¾å¿ƒæŒ‘é€‰ï¼Œæ¶µç›–äº†ä¸åŒçš„è§’åº¦ã€å…‰ç…§æ¡ä»¶å’ŒèƒŒæ™¯ï¼Œä»¥å¢å¼ºæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚æ­¤å¤–ï¼Œä¸ºäº†æé«˜æ•°æ®é›†çš„è´¨é‡ï¼Œæˆ‘ä»¬è¿˜è¿›è¡Œäº†æ•°æ®æ¸…æ´—ï¼Œå‰”é™¤äº†æ¨¡ç³Šæˆ–ä¸æ¸…æ™°çš„å›¾åƒï¼Œç¡®ä¿æ¯ä¸ªæ ·æœ¬éƒ½èƒ½å¤Ÿä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›æœ‰æ•ˆçš„ä¿¡æ¯ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†æ•°æ®å¢å¼ºæŠ€æœ¯ï¼Œä»¥è¿›ä¸€æ­¥æ‰©å±•æ•°æ®é›†çš„è§„æ¨¡å’Œå¤šæ ·æ€§ã€‚è¿™äº›æŠ€æœ¯åŒ…æ‹¬éšæœºè£å‰ªã€æ—‹è½¬ã€ç¿»è½¬ä»¥åŠé¢œè‰²è°ƒæ•´ç­‰ï¼Œæ—¨åœ¨æ¨¡æ‹Ÿç°å®ä¸–ç•Œä¸­å¯èƒ½é‡åˆ°çš„å„ç§æƒ…å†µã€‚è¿™ç§å¢å¼ºä¸ä»…æœ‰åŠ©äºæé«˜æ¨¡å‹çš„é²æ£’æ€§ï¼Œè¿˜èƒ½æœ‰æ•ˆé˜²æ­¢è¿‡æ‹Ÿåˆç°è±¡çš„å‘ç”Ÿã€‚

é€šè¿‡ä½¿ç”¨â€œMotif Batikâ€æ•°æ®é›†ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿæå‡YOLOv8åœ¨å·´è’‚å…‹å›¾æ¡ˆè¯†åˆ«ä»»åŠ¡ä¸­çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚è¯¥æ•°æ®é›†çš„ä¸°å¯Œæ€§å’Œå¤šæ ·æ€§ä¸ºæ¨¡å‹æä¾›äº†è‰¯å¥½çš„è®­ç»ƒåŸºç¡€ï¼Œä½¿å…¶èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œè¯†åˆ«ä¸åŒç±»å‹çš„å·´è’‚å…‹å›¾æ¡ˆã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬æœŸæœ›é€šè¿‡æœ¬ç ”ç©¶çš„æˆæœï¼Œæ¨åŠ¨å·´è’‚å…‹æ–‡åŒ–çš„æ•°å­—åŒ–ä¿å­˜ä¸ä¼ æ’­ï¼Œå¹¶ä¸ºç›¸å…³é¢†åŸŸçš„ç ”ç©¶æä¾›æœ‰ä»·å€¼çš„å‚è€ƒã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œâ€œMotif Batikâ€æ•°æ®é›†ä¸ä»…æ˜¯æœ¬ç ”ç©¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œæ›´æ˜¯å®ç°é«˜æ•ˆå·´è’‚å…‹å›¾æ¡ˆè¯†åˆ«çš„é‡è¦åŸºç¡€ã€‚é€šè¿‡å¯¹è¯¥æ•°æ®é›†çš„æ·±å…¥åˆ†æå’Œåˆ©ç”¨ï¼Œæˆ‘ä»¬ç›¸ä¿¡èƒ½å¤Ÿä¸ºå·´è’‚å…‹å›¾æ¡ˆçš„è‡ªåŠ¨è¯†åˆ«å’Œåˆ†ç±»æä¾›åˆ›æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œæ¨åŠ¨è®¡ç®—æœºè§†è§‰æŠ€æœ¯åœ¨ä¼ ç»Ÿè‰ºæœ¯é¢†åŸŸçš„åº”ç”¨ä¸å‘å±•ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8ç®—æ³•æ˜¯ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„ä¸€æ¬¡é‡è¦é©æ–°ï¼Œå®ƒåœ¨å‰å‡ ä»£YOLOç®—æ³•çš„åŸºç¡€ä¸Šï¼Œç»“åˆäº†æ–°çš„è®¾è®¡ç†å¿µå’ŒæŠ€æœ¯è¿›æ­¥ï¼Œå½¢æˆäº†ä¸€ç§é«˜æ•ˆã€å‡†ç¡®ä¸”çµæ´»çš„ç›®æ ‡æ£€æµ‹è§£å†³æ–¹æ¡ˆã€‚YOLOv8çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡æ”¹è¿›ç½‘ç»œç»“æ„å’ŒæŸå¤±å‡½æ•°ï¼Œæå‡æ¨¡å‹åœ¨å„ç§å¤æ‚åœºæ™¯ä¸‹çš„è¡¨ç°èƒ½åŠ›ã€‚å…¶è®¾è®¡éµå¾ªäº†â€œå¿«é€Ÿã€å‡†ç¡®å’Œæ˜“äºä½¿ç”¨â€çš„åŸåˆ™ï¼Œä½¿å…¶æˆä¸ºå¹¿æ³›åº”ç”¨äºç›®æ ‡æ£€æµ‹ã€å›¾åƒåˆ†å‰²å’Œå›¾åƒåˆ†ç±»ä»»åŠ¡çš„ç†æƒ³é€‰æ‹©ã€‚

åœ¨YOLOv8çš„ç½‘ç»œç»“æ„ä¸­ï¼Œéª¨å¹²ç½‘ç»œï¼ˆBackboneï¼‰ä¾ç„¶é‡‡ç”¨äº†è·¨çº§ç»“æ„ï¼ˆCross Stage Partial, CSPï¼‰çš„è®¾è®¡ç†å¿µï¼Œä½†åœ¨å…·ä½“å®ç°ä¸Šè¿›è¡Œäº†æ˜¾è‘—ä¼˜åŒ–ã€‚YOLOv8å°†YOLOv5ä¸­çš„C3æ¨¡å—æ›¿æ¢ä¸ºæ›´åŠ è½»é‡åŒ–çš„C2Fæ¨¡å—ï¼Œè¿™ä¸€æ”¹è¿›ä¸ä»…å‡å°‘äº†è®¡ç®—é‡ï¼Œè¿˜å¢å¼ºäº†ç‰¹å¾æå–çš„èƒ½åŠ›ã€‚C2Fæ¨¡å—é€šè¿‡å¹¶è¡Œçš„æ¢¯åº¦æµåˆ†æ”¯ï¼Œèƒ½å¤Ÿåœ¨ä¿æŒè½»é‡åŒ–çš„åŒæ—¶ï¼Œè·å–æ›´ä¸°å¯Œçš„ç‰¹å¾ä¿¡æ¯ï¼Œä»è€Œæå‡æ¨¡å‹çš„æ£€æµ‹ç²¾åº¦å’Œå“åº”é€Ÿåº¦ã€‚

åœ¨ç‰¹å¾èåˆå±‚ï¼ˆNeckï¼‰ä¸­ï¼ŒYOLOv8é‡‡ç”¨äº†æ–°çš„è®¾è®¡ç­–ç•¥ï¼Œå»é™¤äº†ä¸Šé‡‡æ ·é˜¶æ®µä¸­çš„å·ç§¯ç»“æ„ï¼Œç›´æ¥å¯¹ä¸åŒé˜¶æ®µè¾“å‡ºçš„ç‰¹å¾è¿›è¡Œä¸Šé‡‡æ ·æ“ä½œã€‚è¿™ä¸€æ”¹åŠ¨ä½¿å¾—ç‰¹å¾èåˆæ›´åŠ é«˜æ•ˆï¼Œå‡å°‘äº†ä¸å¿…è¦çš„è®¡ç®—ï¼Œè¿›ä¸€æ­¥æå‡äº†æ¨¡å‹çš„æ•´ä½“æ€§èƒ½ã€‚åŒæ—¶ï¼ŒYOLOv8å¼•å…¥äº†ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼ˆFPNï¼‰å’Œè·¯å¾„èšåˆç½‘ç»œï¼ˆPANï¼‰çš„ç»“åˆï¼Œå½¢æˆäº†ä¸€ä¸ªæ›´åŠ çµæ´»çš„ç‰¹å¾èåˆæœºåˆ¶ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†ä¸åŒå°ºåº¦çš„ç›®æ ‡ã€‚

YOLOv8åœ¨æ£€æµ‹å¤´ï¼ˆHeadï¼‰éƒ¨åˆ†çš„æ”¹è¿›å°¤ä¸ºæ˜¾è‘—ï¼Œé‡‡ç”¨äº†è§£è€¦å¤´ï¼ˆDecoupled-Headï¼‰ç»“æ„ï¼Œå°†ç›®æ ‡æ£€æµ‹å’Œåˆ†ç±»ä»»åŠ¡åˆ†å¼€å¤„ç†ã€‚è¿™ä¸€è®¾è®¡ä½¿å¾—æ¨¡å‹åœ¨è¿›è¡Œç±»åˆ«é¢„æµ‹å’Œè¾¹ç•Œæ¡†å›å½’æ—¶ï¼Œèƒ½å¤Ÿæ›´åŠ ä¸“æ³¨äºå„è‡ªçš„ä»»åŠ¡ï¼Œä»è€Œæé«˜äº†æ£€æµ‹çš„å‡†ç¡®æ€§ã€‚æ­¤å¤–ï¼ŒYOLOv8æ‘’å¼ƒäº†ä¼ ç»Ÿçš„åŸºäºé”šæ¡†ï¼ˆAnchor-Basedï¼‰çš„æ–¹æ³•ï¼Œè½¬è€Œé‡‡ç”¨æ— é”šæ¡†ï¼ˆAnchor-Freeï¼‰ç­–ç•¥ï¼Œå°†ç›®æ ‡æ£€æµ‹é—®é¢˜è½¬åŒ–ä¸ºå…³é”®ç‚¹æ£€æµ‹ã€‚è¿™ä¸€è½¬å˜ä¸ä»…ç®€åŒ–äº†æ¨¡å‹çš„ç»“æ„ï¼Œè¿˜å¢å¼ºäº†å…¶åœ¨å¤„ç†å¤šæ ·åŒ–ç›®æ ‡æ—¶çš„çµæ´»æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚

åœ¨æŸå¤±å‡½æ•°çš„è®¾è®¡ä¸Šï¼ŒYOLOv8ä¹Ÿè¿›è¡Œäº†åˆ›æ–°ã€‚å®ƒå¼•å…¥äº†å˜ç„¦æŸå¤±ï¼ˆFocal Lossï¼‰æ¥è®¡ç®—åˆ†ç±»æŸå¤±ï¼Œå¹¶ä½¿ç”¨æ•°æ®å¹³å‡ä¿çœŸåº¦æŸå¤±å’Œå®Œç¾äº¤å¹¶æ¯”æŸå¤±æ¥è®¡ç®—è¾¹ç•Œæ¡†æŸå¤±ã€‚è¿™ç§æ–°çš„æŸå¤±ç­–ç•¥ä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ›´åŠ å…³æ³¨éš¾ä»¥æ£€æµ‹çš„ç›®æ ‡ï¼Œæé«˜äº†æ•´ä½“çš„æ£€æµ‹ç²¾åº¦ã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨è®­ç»ƒé˜¶æ®µé‡‡ç”¨äº†Mosaicæ•°æ®å¢å¼ºæŠ€æœ¯ï¼Œé€šè¿‡å°†å¤šå¼ å›¾åƒæ‹¼æ¥æˆä¸€å¼ æ–°å›¾åƒï¼Œè¿«ä½¿æ¨¡å‹å­¦ä¹ åˆ°æ›´å¤šçš„ç‰¹å¾å’Œä½ç½®å˜åŒ–ï¼Œä»è€Œæå‡äº†æ¨¡å‹çš„é²æ£’æ€§ã€‚

YOLOv8çš„è¾“å…¥éƒ¨åˆ†ä¹Ÿè¿›è¡Œäº†ä¼˜åŒ–ï¼Œé‡‡ç”¨è‡ªé€‚åº”å›¾åƒç¼©æ”¾æŠ€æœ¯ï¼Œä»¥æé«˜ç›®æ ‡æ£€æµ‹å’Œæ¨ç†çš„é€Ÿåº¦ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¾“å…¥å›¾åƒçš„é•¿å®½æ¯”å¾€å¾€å„ä¸ç›¸åŒï¼ŒYOLOv8é€šè¿‡å°†é•¿è¾¹æŒ‰æ¯”ä¾‹ç¼©å°åˆ°æŒ‡å®šå°ºå¯¸ï¼Œç„¶åå¯¹çŸ­è¾¹è¿›è¡Œå¡«å……ï¼Œå°½é‡å‡å°‘ä¿¡æ¯å†—ä½™ï¼Œç¡®ä¿æ¨¡å‹èƒ½å¤Ÿåœ¨ä¸åŒåœºæ™¯ä¸‹å¿«é€Ÿè€Œå‡†ç¡®åœ°è¿›è¡Œç›®æ ‡æ£€æµ‹ã€‚

æ€»çš„æ¥è¯´ï¼ŒYOLOv8ç®—æ³•é€šè¿‡ä¸€ç³»åˆ—ç»“æ„æ€§å’Œç­–ç•¥æ€§çš„æ”¹è¿›ï¼Œæ˜¾è‘—æå‡äº†ç›®æ ‡æ£€æµ‹çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚å…¶è½»é‡åŒ–çš„è®¾è®¡ä½¿å¾—æ¨¡å‹åœ¨ä¿æŒé«˜æ€§èƒ½çš„åŒæ—¶ï¼Œèƒ½å¤Ÿé€‚åº”å„ç§è®¡ç®—èµ„æºæœ‰é™çš„åº”ç”¨åœºæ™¯ã€‚éšç€YOLOv8çš„å¹¿æ³›åº”ç”¨ï¼Œç›®æ ‡æ£€æµ‹æŠ€æœ¯çš„è¾¹ç•Œä¸æ–­è¢«æ‹“å±•ï¼Œæ¨åŠ¨äº†è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„è¿›ä¸€æ­¥å‘å±•ã€‚é€šè¿‡è¿™äº›åˆ›æ–°ï¼ŒYOLOv8ä¸ä»…ä¸ºç ”ç©¶äººå‘˜æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä¹Ÿä¸ºå®é™…åº”ç”¨ä¸­çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œå±•ç°äº†å…¶åœ¨æœªæ¥å‘å±•ä¸­çš„å·¨å¤§æ½œåŠ›ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\extra_modules\ops_dcnv3\modules\__init__.py

ä¸‹é¢æ˜¯å¯¹æ‚¨æä¾›çš„ä»£ç è¿›è¡Œçš„é€æ–‡ä»¶åˆ†æï¼Œå¹¶ä¿ç•™äº†æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼ŒåŒæ—¶æ·»åŠ äº†è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šã€‚

```python
# --------------------------------------------------------
# InternImage
# ç‰ˆæƒæ‰€æœ‰ (c) 2022 OpenGVLab
# æ ¹æ® MIT è®¸å¯è¯è¿›è¡Œè®¸å¯ [è¯¦ç»†ä¿¡æ¯è§ LICENSE]
# --------------------------------------------------------

# ä»å½“å‰åŒ…ä¸­å¯¼å…¥ DCNv3ã€DCNv3_pytorch å’Œ DCNv3_DyHead æ¨¡å—
from .dcnv3 import DCNv3, DCNv3_pytorch, DCNv3_DyHead

# DCNv3 æ˜¯ä¸€ç§æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç½‘ç»œï¼Œå¯èƒ½ç”¨äºæé«˜å·ç§¯ç¥ç»ç½‘ç»œçš„æ€§èƒ½ã€‚
# DCNv3_pytorch æ˜¯ DCNv3 åœ¨ PyTorch æ¡†æ¶ä¸‹çš„å®ç°ã€‚
# DCNv3_DyHead å¯èƒ½æ˜¯ä¸€ä¸ªåŠ¨æ€å¤´éƒ¨æ¨¡å—ï¼Œç”¨äºå¤„ç†ä¸åŒçš„ä»»åŠ¡æˆ–ç‰¹å¾æå–ã€‚
```

### æ ¸å¿ƒéƒ¨åˆ†åˆ†æ
1. **æ¨¡å—å¯¼å…¥**ï¼šè¿™æ®µä»£ç çš„æ ¸å¿ƒåœ¨äºä» `dcnv3` æ¨¡å—ä¸­å¯¼å…¥äº†ä¸‰ä¸ªç±»æˆ–å‡½æ•°ã€‚è¿™äº›å¯¼å…¥çš„æ¨¡å—å¯èƒ½æ˜¯å®ç°æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸­é‡è¦çš„ç»„ä»¶ã€‚

2. **æ³¨é‡Š**ï¼šæ³¨é‡Šéƒ¨åˆ†è§£é‡Šäº†æ¯ä¸ªå¯¼å…¥çš„æ¨¡å—çš„å¯èƒ½ç”¨é€”ï¼Œå¸®åŠ©ç†è§£å®ƒä»¬åœ¨æ•´ä¸ªé¡¹ç›®ä¸­çš„è§’è‰²ã€‚

ä»¥ä¸Šæ˜¯å¯¹ä»£ç çš„ç®€åŒ–å’Œæ³¨é‡Šï¼Œå¸Œæœ›èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£å…¶æ ¸å¿ƒå†…å®¹ã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªPythonæ¨¡å—çš„åˆå§‹åŒ–æ–‡ä»¶ï¼Œä½äºä¸€ä¸ªåä¸º`ops_dcnv3`çš„ç›®å½•ä¸‹ã€‚æ–‡ä»¶çš„å¼€å¤´åŒ…å«äº†ä¸€äº›ç‰ˆæƒä¿¡æ¯ï¼Œè¡¨æ˜è¯¥ä»£ç æ˜¯ç”±OpenGVLabåœ¨2022å¹´å¼€å‘çš„ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®MITè®¸å¯è¯è¿›è¡Œæˆæƒçš„ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘è¯¥ä»£ç ï¼Œåªè¦éµå¾ªè®¸å¯è¯çš„æ¡æ¬¾ã€‚

åœ¨æ–‡ä»¶çš„ä¸»ä½“éƒ¨åˆ†ï¼Œä½¿ç”¨äº†`from ... import ...`è¯­å¥æ¥å¯¼å…¥å…¶ä»–æ¨¡å—ä¸­çš„ç±»æˆ–å‡½æ•°ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™é‡Œå¯¼å…¥äº†ä¸‰ä¸ªç»„ä»¶ï¼š`DCNv3`ã€`DCNv3_pytorch`å’Œ`DCNv3_DyHead`ã€‚è¿™äº›ç»„ä»¶å¯èƒ½æ˜¯ä¸æ·±åº¦å­¦ä¹ æ¨¡å‹ç›¸å…³çš„ï¼Œå°¤å…¶æ˜¯åœ¨YOLOv8ç®—æ³•çš„ä¸Šä¸‹æ–‡ä¸­ã€‚`DCNv3`é€šå¸¸æŒ‡çš„æ˜¯ä¸€ç§æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å®ç°ï¼Œå¯èƒ½ç”¨äºæé«˜æ¨¡å‹çš„æ€§èƒ½å’Œæ•ˆç‡ã€‚

é€šè¿‡è¿™ä¸ªåˆå§‹åŒ–æ–‡ä»¶ï¼Œç”¨æˆ·åœ¨å¯¼å…¥`ops_dcnv3`æ¨¡å—æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›å¯¼å…¥çš„ç±»æˆ–å‡½æ•°ï¼Œè€Œä¸éœ€è¦å•ç‹¬å»å¼•ç”¨å®ƒä»¬æ‰€åœ¨çš„æ–‡ä»¶ã€‚è¿™ç§ç»“æ„ä½¿å¾—ä»£ç çš„ç»„ç»‡æ›´åŠ æ¸…æ™°ï¼Œå¹¶ä¸”ä¾¿äºç”¨æˆ·ä½¿ç”¨å’Œç»´æŠ¤ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯ä¸º`ops_dcnv3`æ¨¡å—æä¾›ä¸€ä¸ªå…¥å£ç‚¹ï¼Œæ–¹ä¾¿ç”¨æˆ·è®¿é—®å’Œä½¿ç”¨ä¸DCNï¼ˆDeformable Convolutional Networksï¼‰ç›¸å…³çš„åŠŸèƒ½ã€‚

#### 11.2 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\utils\plotting.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦åŒ…æ‹¬ `Colors` å’Œ `Annotator` ç±»çš„å®ç°ã€‚è¿™äº›ç±»ç”¨äºå¤„ç†é¢œè‰²å’Œå›¾åƒæ³¨é‡Šï¼Œé€‚ç”¨äºç›®æ ‡æ£€æµ‹å’Œå›¾åƒæ ‡æ³¨ä»»åŠ¡ã€‚

```python
import numpy as np
from PIL import Image, ImageDraw, ImageFont
import cv2
import torch

class Colors:
    """
    é¢œè‰²ç±»ï¼Œç”¨äºå¤„ç†é¢œè‰²è°ƒè‰²æ¿ï¼ŒåŒ…æ‹¬å°†åå…­è¿›åˆ¶é¢œè‰²ä»£ç è½¬æ¢ä¸ºRGBå€¼ã€‚
    """

    def __init__(self):
        """åˆå§‹åŒ–é¢œè‰²è°ƒè‰²æ¿ï¼Œä½¿ç”¨åå…­è¿›åˆ¶é¢œè‰²ä»£ç ã€‚"""
        hexs = ('FF3838', 'FF9D97', 'FF701F', 'FFB21D', 'CFD231', 
                '48F90A', '92CC17', '3DDB86', '1A9334', '00D4BB',
                '2C99A8', '00C2FF', '344593', '6473FF', '0018EC', 
                '8438FF', '520085', 'CB38FF', 'FF95C8', 'FF37C7')
        # å°†åå…­è¿›åˆ¶é¢œè‰²è½¬æ¢ä¸ºRGBæ ¼å¼
        self.palette = [self.hex2rgb(f'#{c}') for c in hexs]
        self.n = len(self.palette)  # é¢œè‰²æ•°é‡

    def __call__(self, i, bgr=False):
        """æ ¹æ®ç´¢å¼•è¿”å›é¢œè‰²ï¼Œæ”¯æŒBGRæ ¼å¼ã€‚"""
        c = self.palette[int(i) % self.n]  # è·å–é¢œè‰²
        return (c[2], c[1], c[0]) if bgr else c  # è¿”å›BGRæˆ–RGBæ ¼å¼

    @staticmethod
    def hex2rgb(h):
        """å°†åå…­è¿›åˆ¶é¢œè‰²ä»£ç è½¬æ¢ä¸ºRGBå€¼ã€‚"""
        return tuple(int(h[1 + i:1 + i + 2], 16) for i in (0, 2, 4))


class Annotator:
    """
    æ³¨é‡Šç±»ï¼Œç”¨äºåœ¨å›¾åƒä¸Šç»˜åˆ¶è¾¹ç•Œæ¡†ã€å…³é”®ç‚¹å’Œå…¶ä»–æ³¨é‡Šã€‚
    """

    def __init__(self, im, line_width=None, font_size=None, font='Arial.ttf', pil=False):
        """åˆå§‹åŒ–Annotatorç±»ï¼Œè®¾ç½®å›¾åƒå’Œç»˜åˆ¶å‚æ•°ã€‚"""
        self.im = im if isinstance(im, Image.Image) else Image.fromarray(im)  # è½¬æ¢ä¸ºPILå›¾åƒ
        self.draw = ImageDraw.Draw(self.im)  # åˆ›å»ºç»˜å›¾å¯¹è±¡
        self.lw = line_width or 2  # çº¿å®½
        # å°è¯•åŠ è½½å­—ä½“
        try:
            self.font = ImageFont.truetype(font, font_size or 12)
        except Exception:
            self.font = ImageFont.load_default()  # åŠ è½½é»˜è®¤å­—ä½“

    def box_label(self, box, label='', color=(128, 128, 128), txt_color=(255, 255, 255)):
        """åœ¨å›¾åƒä¸Šæ·»åŠ è¾¹ç•Œæ¡†å’Œæ ‡ç­¾ã€‚"""
        # ç»˜åˆ¶è¾¹ç•Œæ¡†
        self.draw.rectangle(box, width=self.lw, outline=color)
        if label:
            # è·å–æ–‡æœ¬çš„å®½åº¦å’Œé«˜åº¦
            w, h = self.font.getsize(label)
            # åœ¨è¾¹ç•Œæ¡†ä¸Šæ–¹ç»˜åˆ¶æ ‡ç­¾
            self.draw.text((box[0], box[1] - h), label, fill=txt_color, font=self.font)

    def result(self):
        """è¿”å›æ³¨é‡Šåçš„å›¾åƒä½œä¸ºæ•°ç»„ã€‚"""
        return np.asarray(self.im)  # å°†PILå›¾åƒè½¬æ¢ä¸ºnumpyæ•°ç»„
```

### ä»£ç è¯´æ˜
1. **Colors ç±»**ï¼š
   - ç”¨äºç®¡ç†é¢œè‰²è°ƒè‰²æ¿ï¼Œæ”¯æŒå°†åå…­è¿›åˆ¶é¢œè‰²ä»£ç è½¬æ¢ä¸ºRGBæ ¼å¼ã€‚
   - `__call__` æ–¹æ³•å…è®¸é€šè¿‡ç´¢å¼•è·å–é¢œè‰²ï¼Œæ”¯æŒBGRæ ¼å¼çš„è¿”å›ã€‚

2. **Annotator ç±»**ï¼š
   - ç”¨äºåœ¨å›¾åƒä¸Šç»˜åˆ¶è¾¹ç•Œæ¡†ã€æ–‡æœ¬å’Œå…¶ä»–æ³¨é‡Šã€‚
   - `box_label` æ–¹æ³•ç”¨äºç»˜åˆ¶è¾¹ç•Œæ¡†å¹¶åœ¨å…¶ä¸Šæ–¹æ·»åŠ æ ‡ç­¾ã€‚
   - `result` æ–¹æ³•è¿”å›å¤„ç†åçš„å›¾åƒã€‚

è¿™éƒ¨åˆ†ä»£ç æ˜¯ç›®æ ‡æ£€æµ‹å’Œå›¾åƒå¤„ç†ä»»åŠ¡ä¸­å¸¸ç”¨çš„åŸºç¡€ç»„ä»¶ï¼Œèƒ½å¤Ÿå®ç°å›¾åƒçš„å¯è§†åŒ–å’Œæ ‡æ³¨åŠŸèƒ½ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ç”¨äºUltralytics YOLOï¼ˆYou Only Look Onceï¼‰æ¨¡å‹çš„å¯è§†åŒ–å’Œç»˜å›¾å·¥å…·ï¼Œä¸»è¦åŒ…æ‹¬å›¾åƒæ ‡æ³¨ã€ç»˜åˆ¶ç»“æœã€ä¿å­˜å›¾åƒç­‰åŠŸèƒ½ã€‚æ–‡ä»¶ä¸­åŒ…å«å¤šä¸ªç±»å’Œå‡½æ•°ï¼Œä¸‹é¢æ˜¯å¯¹ä¸»è¦éƒ¨åˆ†çš„è®²è§£ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬ç”¨äºå›¾åƒå¤„ç†çš„OpenCVã€Matplotlibã€NumPyã€Torchç­‰ï¼Œä»¥åŠPILåº“ç”¨äºå¤„ç†å›¾åƒã€‚æ¥ç€ï¼Œå®šä¹‰äº†ä¸€ä¸ª`Colors`ç±»ï¼Œç”¨äºç®¡ç†é¢œè‰²è°ƒè‰²æ¿ï¼Œæ”¯æŒå°†åå…­è¿›åˆ¶é¢œè‰²ä»£ç è½¬æ¢ä¸ºRGBå€¼ï¼Œå¹¶æä¾›äº†ä¸€äº›é»˜è®¤çš„é¢œè‰²å€¼ã€‚

æ¥ä¸‹æ¥æ˜¯`Annotator`ç±»ï¼Œå®ƒæ˜¯å›¾åƒæ ‡æ³¨çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚è¯¥ç±»åˆå§‹åŒ–æ—¶æ¥å—å›¾åƒã€çº¿å®½ã€å­—ä½“ç­‰å‚æ•°ï¼Œå¹¶æ ¹æ®è¿™äº›å‚æ•°è®¾ç½®ç»˜å›¾ç¯å¢ƒã€‚`Annotator`ç±»æä¾›äº†å¤šç§æ–¹æ³•ï¼Œä¾‹å¦‚`box_label`ç”¨äºåœ¨å›¾åƒä¸Šç»˜åˆ¶è¾¹æ¡†å’Œæ ‡ç­¾ï¼Œ`masks`ç”¨äºç»˜åˆ¶åˆ†å‰²æ©ç ï¼Œ`kpts`ç”¨äºç»˜åˆ¶å…³é”®ç‚¹ï¼Œ`rectangle`å’Œ`text`æ–¹æ³•åˆ™ç”¨äºåœ¨å›¾åƒä¸Šç»˜åˆ¶çŸ©å½¢å’Œæ–‡æœ¬ã€‚

æ­¤å¤–ï¼Œæ–‡ä»¶ä¸­è¿˜å®šä¹‰äº†ä¸€äº›å‡½æ•°ï¼Œå¦‚`plot_labels`ç”¨äºç»˜åˆ¶è®­ç»ƒæ ‡ç­¾çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œ`save_one_box`ç”¨äºæ ¹æ®ç»™å®šçš„è¾¹ç•Œæ¡†ä»å›¾åƒä¸­è£å‰ªå¹¶ä¿å­˜å›¾åƒï¼Œ`plot_images`ç”¨äºç»˜åˆ¶å›¾åƒç½‘æ ¼å¹¶æ·»åŠ æ ‡ç­¾ï¼Œ`plot_results`ç”¨äºä»CSVæ–‡ä»¶ä¸­ç»˜åˆ¶è®­ç»ƒç»“æœã€‚

æ–‡ä»¶çš„æœ€åéƒ¨åˆ†åŒ…å«äº†ä¸€äº›ç”¨äºå¯è§†åŒ–ç‰¹å¾å›¾çš„å‡½æ•°ï¼Œä¾‹å¦‚`feature_visualization`ï¼Œå®ƒå¯ä»¥åœ¨æ¨ç†è¿‡ç¨‹ä¸­å¯è§†åŒ–ç‰¹å®šæ¨¡å—çš„ç‰¹å¾å›¾ã€‚è¿™ä¸ªåŠŸèƒ½å¯¹äºè°ƒè¯•å’Œç†è§£æ¨¡å‹çš„å†…éƒ¨å·¥ä½œåŸç†éå¸¸æœ‰ç”¨ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶æä¾›äº†ä¸€æ•´å¥—ç”¨äºYOLOæ¨¡å‹çš„å¯è§†åŒ–å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£æ¨¡å‹çš„é¢„æµ‹ç»“æœå’Œè®­ç»ƒè¿‡ç¨‹ã€‚é€šè¿‡è¿™äº›å·¥å…·ï¼Œç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œæ•°æ®åˆ†æã€ç»“æœå±•ç¤ºå’Œæ¨¡å‹è°ƒè¯•ã€‚

#### 11.3 ui.py

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤
    result = subprocess.run(command, shell=True)
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")


# å®ä¾‹åŒ–å¹¶è¿è¡Œåº”ç”¨
if __name__ == "__main__":
    # æŒ‡å®šæ‚¨çš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # è¿™é‡Œç›´æ¥æŒ‡å®šè„šæœ¬è·¯å¾„

    # è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š

1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `import sys`ï¼šå¯¼å…¥ç³»ç»Ÿç›¸å…³çš„æ¨¡å—ï¼Œç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `import subprocess`ï¼šå¯¼å…¥å­è¿›ç¨‹æ¨¡å—ï¼Œç”¨äºåœ¨ Python ä¸­æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **å®šä¹‰å‡½æ•° `run_script`**ï¼š
   - è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚
   - å‡½æ•°å†…éƒ¨é¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œå­˜å‚¨åœ¨ `python_path` å˜é‡ä¸­ã€‚
   - ç„¶åæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸² `command`ï¼Œè¯¥å‘½ä»¤ä½¿ç”¨å½“å‰ Python è§£é‡Šå™¨è¿è¡Œ `streamlit` æ¨¡å—ï¼Œå¹¶æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œæ„å»ºçš„å‘½ä»¤ï¼Œå¹¶å°† `shell` å‚æ•°è®¾ç½®ä¸º `True`ï¼Œä»¥ä¾¿åœ¨ shell ä¸­è¿è¡Œå‘½ä»¤ã€‚
   - å¦‚æœå‘½ä»¤æ‰§è¡Œåè¿”å›çš„çŠ¶æ€ç ä¸ä¸º 0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºå—**ï¼š
   - ä½¿ç”¨ `if __name__ == "__main__":` ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥è„šæœ¬æ—¶æ‰ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚
   - æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ `script_path`ï¼Œè¿™é‡Œç›´æ¥èµ‹å€¼ä¸º `"web.py"`ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°ï¼Œä¼ å…¥æŒ‡å®šçš„è„šæœ¬è·¯å¾„ï¼Œå¼€å§‹æ‰§è¡Œè„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ªåä¸º `web.py` çš„è„šæœ¬ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œä»¥åŠä¸€ä¸ªè‡ªå®šä¹‰çš„ `abs_path` å‡½æ•°ï¼Œç”¨äºè·å–è„šæœ¬çš„ç»å¯¹è·¯å¾„ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œé¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ Python ç¯å¢ƒæ¥æ‰§è¡Œè„šæœ¬ã€‚æ¥ç€ï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå‘½ä»¤ä½¿ç”¨ `streamlit` æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚`streamlit` æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæ•°æ®åº”ç”¨çš„æ¡†æ¶ï¼Œå› æ­¤è¿™é‡Œçš„è„šæœ¬å¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªä¸æ•°æ®å¯è§†åŒ–æˆ–äº¤äº’å¼åº”ç”¨ç›¸å…³çš„ Python è„šæœ¬ã€‚

éšåï¼Œä½¿ç”¨ `subprocess.run` æ–¹æ³•æ¥æ‰§è¡Œæ„å»ºå¥½çš„å‘½ä»¤ã€‚è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ä¸€ä¸ªæ–°çš„ shell ä¸­è¿è¡Œå‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œåè¿”å›çš„çŠ¶æ€ç ä¸ä¸ºé›¶ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯ï¼Œæ­¤æ—¶ç¨‹åºä¼šæ‰“å°å‡ºâ€œè„šæœ¬è¿è¡Œå‡ºé”™â€çš„æç¤ºä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥æ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚è¿™éƒ¨åˆ†ä»£ç æŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼Œå³é€šè¿‡ `abs_path` å‡½æ•°è·å–çš„ `web.py` çš„ç»å¯¹è·¯å¾„ï¼Œå¹¶è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚

æ€»ä½“æ¥çœ‹ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶çš„ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½æ˜ç¡®ï¼Œä¸»è¦ç”¨äºæ–¹ä¾¿åœ°è¿è¡Œä¸€ä¸ªç‰¹å®šçš„ Python è„šæœ¬ï¼Œå¹¶èƒ½å¤Ÿå¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚

#### 11.4 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\nas\model.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
from pathlib import Path
import torch
from ultralytics.engine.model import Model
from ultralytics.utils.torch_utils import model_info, smart_inference_mode
from .predict import NASPredictor
from .val import NASValidator

class NAS(Model):
    """
    YOLO NASæ¨¡å‹ç”¨äºç›®æ ‡æ£€æµ‹ã€‚

    è¯¥ç±»æä¾›YOLO-NASæ¨¡å‹çš„æ¥å£ï¼Œå¹¶æ‰©å±•äº†Ultralyticså¼•æ“ä¸­çš„`Model`ç±»ã€‚
    æ—¨åœ¨ä½¿ç”¨é¢„è®­ç»ƒæˆ–è‡ªå®šä¹‰è®­ç»ƒçš„YOLO-NASæ¨¡å‹æ¥ç®€åŒ–ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚
    """

    def __init__(self, model='yolo_nas_s.pt') -> None:
        """åˆå§‹åŒ–NASæ¨¡å‹ï¼Œä½¿ç”¨æä¾›çš„æˆ–é»˜è®¤çš„'yolo_nas_s.pt'æ¨¡å‹ã€‚"""
        # ç¡®ä¿æä¾›çš„æ¨¡å‹ä¸æ˜¯YAMLé…ç½®æ–‡ä»¶
        assert Path(model).suffix not in ('.yaml', '.yml'), 'YOLO-NASæ¨¡å‹ä»…æ”¯æŒé¢„è®­ç»ƒæ¨¡å‹ã€‚'
        super().__init__(model, task='detect')  # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°

    @smart_inference_mode()
    def _load(self, weights: str, task: str):
        """åŠ è½½ç°æœ‰çš„NASæ¨¡å‹æƒé‡ï¼Œæˆ–åˆ›å»ºä¸€ä¸ªæ–°çš„NASæ¨¡å‹ï¼ˆå¦‚æœæœªæä¾›æƒé‡ï¼‰ã€‚"""
        import super_gradients
        suffix = Path(weights).suffix
        if suffix == '.pt':
            self.model = torch.load(weights)  # ä».ptæ–‡ä»¶åŠ è½½æ¨¡å‹
        elif suffix == '':
            self.model = super_gradients.training.models.get(weights, pretrained_weights='coco')  # è·å–é¢„è®­ç»ƒæ¨¡å‹

        # æ ‡å‡†åŒ–æ¨¡å‹è®¾ç½®
        self.model.fuse = lambda verbose=True: self.model  # èåˆæ¨¡å‹
        self.model.stride = torch.tensor([32])  # è®¾ç½®æ­¥å¹…
        self.model.names = dict(enumerate(self.model._class_names))  # è®¾ç½®ç±»åˆ«åç§°
        self.model.is_fused = lambda: False  # è¿”å›æ¨¡å‹æ˜¯å¦å·²èåˆ
        self.model.yaml = {}  # æ¸…ç©ºyamlé…ç½®
        self.model.pt_path = weights  # è®¾ç½®æƒé‡è·¯å¾„
        self.model.task = 'detect'  # è®¾ç½®ä»»åŠ¡ç±»å‹

    def info(self, detailed=False, verbose=True):
        """
        è®°å½•æ¨¡å‹ä¿¡æ¯ã€‚

        å‚æ•°:
            detailed (bool): æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚
            verbose (bool): æ§åˆ¶è¾“å‡ºçš„è¯¦ç»†ç¨‹åº¦ã€‚
        """
        return model_info(self.model, detailed=detailed, verbose=verbose, imgsz=640)

    @property
    def task_map(self):
        """è¿”å›ä»»åŠ¡ä¸ç›¸åº”é¢„æµ‹å™¨å’ŒéªŒè¯å™¨ç±»çš„æ˜ å°„å­—å…¸ã€‚"""
        return {'detect': {'predictor': NASPredictor, 'validator': NASValidator}}
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š

1. **ç±»å®šä¹‰**ï¼š`NAS`ç±»ç»§æ‰¿è‡ª`Model`ç±»ï¼Œä¸“é—¨ç”¨äºYOLO-NASæ¨¡å‹çš„ç›®æ ‡æ£€æµ‹ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼š`__init__`æ–¹æ³•ç”¨äºåˆå§‹åŒ–æ¨¡å‹ï¼Œç¡®ä¿æ¨¡å‹æ–‡ä»¶ä¸æ˜¯YAMLæ ¼å¼ï¼Œå¹¶è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚
3. **åŠ è½½æ¨¡å‹**ï¼š`_load`æ–¹æ³•æ ¹æ®æä¾›çš„æƒé‡æ–‡ä»¶åŠ è½½æ¨¡å‹ï¼Œæ”¯æŒä»`.pt`æ–‡ä»¶æˆ–é¢„è®­ç»ƒæ¨¡å‹è·å–ã€‚
4. **æ¨¡å‹æ ‡å‡†åŒ–**ï¼šåœ¨åŠ è½½æ¨¡å‹åï¼Œè®¾ç½®ä¸€äº›æ¨¡å‹çš„æ ‡å‡†å±æ€§ï¼Œä¾‹å¦‚æ­¥å¹…ã€ç±»åˆ«åç§°ç­‰ã€‚
5. **æ¨¡å‹ä¿¡æ¯**ï¼š`info`æ–¹æ³•ç”¨äºè®°å½•å’Œè¿”å›æ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ã€‚
6. **ä»»åŠ¡æ˜ å°„**ï¼š`task_map`å±æ€§è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œæ˜ å°„ç›®æ ‡æ£€æµ‹ä»»åŠ¡åˆ°ç›¸åº”çš„é¢„æµ‹å™¨å’ŒéªŒè¯å™¨ç±»ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºYOLO-NASæ¨¡å‹çš„æ¥å£å®ç°ï¼Œå±äºUltralytics YOLOæ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚YOLO-NASæ˜¯ä¸€ç§ç”¨äºç›®æ ‡æ£€æµ‹çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º`NAS`çš„ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ªUltralyticså¼•æ“ä¸­çš„`Model`ç±»ã€‚

åœ¨æ–‡ä»¶çš„å¼€å¤´ï¼Œé¦–å…ˆå¼•å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬`Path`ï¼ˆç”¨äºå¤„ç†æ–‡ä»¶è·¯å¾„ï¼‰ã€`torch`ï¼ˆPyTorchåº“ï¼‰ä»¥åŠUltralyticså¼•æ“ä¸­çš„ä¸€äº›åŠŸèƒ½æ¨¡å—ã€‚æ¥ç€ï¼Œæ–‡ä»¶æä¾›äº†ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨`NAS`ç±»æ¥åŠ è½½æ¨¡å‹å¹¶è¿›è¡Œé¢„æµ‹ã€‚

`NAS`ç±»çš„æ„é€ å‡½æ•°`__init__`æ¥å—ä¸€ä¸ªå‚æ•°`model`ï¼Œè¯¥å‚æ•°æŒ‡å®šäº†è¦åŠ è½½çš„é¢„è®­ç»ƒæ¨¡å‹çš„è·¯å¾„æˆ–åç§°ï¼Œé»˜è®¤å€¼ä¸º'yolo_nas_s.pt'ã€‚åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œç¨‹åºä¼šæ£€æŸ¥æä¾›çš„æ¨¡å‹æ–‡ä»¶æ˜¯å¦ä¸ºYAMLæ ¼å¼ï¼ŒYOLO-NASæ¨¡å‹åªæ”¯æŒé¢„è®­ç»ƒæ¨¡å‹ï¼Œå› æ­¤å¦‚æœæä¾›äº†YAMLæ–‡ä»¶ï¼Œç¨‹åºä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

`_load`æ–¹æ³•ç”¨äºåŠ è½½æ¨¡å‹æƒé‡ã€‚å¦‚æœæä¾›çš„æƒé‡æ–‡ä»¶æ˜¯ä»¥`.pt`ç»“å°¾ï¼Œç¨‹åºä¼šä½¿ç”¨`torch.load`åŠ è½½è¯¥æ¨¡å‹ï¼›å¦‚æœæ²¡æœ‰åç¼€ï¼Œç¨‹åºä¼šå°è¯•ä»`super_gradients`åº“ä¸­è·å–ç›¸åº”çš„æ¨¡å‹ï¼Œå¹¶åŠ è½½COCOæ•°æ®é›†çš„é¢„è®­ç»ƒæƒé‡ã€‚è¯¥æ–¹æ³•è¿˜ä¼šå¯¹æ¨¡å‹è¿›è¡Œæ ‡å‡†åŒ–è®¾ç½®ï¼ŒåŒ…æ‹¬å®šä¹‰æ¨¡å‹çš„æ­¥å¹…ã€ç±»åˆ«åç§°ç­‰ã€‚

`info`æ–¹æ³•ç”¨äºè®°å½•æ¨¡å‹çš„ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯å’Œæ§åˆ¶è¾“å‡ºçš„è¯¦ç»†ç¨‹åº¦ã€‚è¯¥æ–¹æ³•è°ƒç”¨äº†`model_info`å‡½æ•°æ¥è·å–å¹¶è¿”å›æ¨¡å‹çš„ç›¸å…³ä¿¡æ¯ã€‚

æœ€åï¼Œ`task_map`å±æ€§è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œæ˜ å°„äº†ä»»åŠ¡ç±»å‹åˆ°ç›¸åº”çš„é¢„æµ‹å™¨å’ŒéªŒè¯å™¨ç±»ï¼Œè¿™é‡Œä»…æ”¯æŒç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼Œå¹¶å¯¹åº”äº†`NASPredictor`å’Œ`NASValidator`ç±»ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†YOLO-NASæ¨¡å‹çš„åŸºæœ¬æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·åŠ è½½é¢„è®­ç»ƒæ¨¡å‹å¹¶è¿›è¡Œç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ŒåŒæ—¶æä¾›äº†ä¸€äº›è¾…åŠ©åŠŸèƒ½æ¥è·å–æ¨¡å‹ä¿¡æ¯å’Œç®¡ç†ä»»åŠ¡ã€‚

#### 11.5 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»ç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œç»§æ‰¿è‡ªBaseTrainerç±»ã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œå¯ä»¥æ˜¯'train'æˆ–'val'ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„æ•°æ®å¢å¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äº'rect'æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)  # è·å–æ¨¡å‹çš„æœ€å¤§æ­¥å¹…
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„é€ å¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼æœ‰æ•ˆ
        with torch_distributed_zero_first(rank):  # ä»…åœ¨DDPä¸­åˆå§‹åŒ–æ•°æ®é›†*.cacheä¸€æ¬¡
            dataset = self.build_dataset(dataset_path, mode, batch_size)  # æ„å»ºæ•°æ®é›†
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        if getattr(dataset, "rect", False) and shuffle:
            LOGGER.warning("WARNING âš ï¸ 'rect=True' is incompatible with DataLoader shuffle, setting shuffle=False")
            shuffle = False  # å¦‚æœæ˜¯rectæ¨¡å¼ä¸”éœ€è¦æ‰“ä¹±ï¼Œåˆ™ä¸æ‰“ä¹±
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬ç§»åˆ°è®¾å¤‡å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©æ–°çš„å°ºå¯¸
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼
            batch["img"] = imgs  # æ›´æ–°å›¾åƒ
        return batch

    def set_model_attributes(self):
        """è®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œåç§°ã€‚"""
        self.model.nc = self.data["nc"]  # å°†ç±»åˆ«æ•°é‡é™„åŠ åˆ°æ¨¡å‹
        self.model.names = self.data["names"]  # å°†ç±»åˆ«åç§°é™„åŠ åˆ°æ¨¡å‹
        self.model.args = self.args  # å°†è¶…å‚æ•°é™„åŠ åˆ°æ¨¡å‹

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›YOLOæ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def get_validator(self):
        """è¿”å›YOLOæ¨¡å‹éªŒè¯å™¨ã€‚"""
        self.loss_names = "box_loss", "cls_loss", "dfl_loss"  # å®šä¹‰æŸå¤±åç§°
        return yolo.detect.DetectionValidator(
            self.test_loader, save_dir=self.save_dir, args=copy(self.args), _callbacks=self.callbacks
        )

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )

    def plot_metrics(self):
        """ä»CSVæ–‡ä»¶ä¸­ç»˜åˆ¶æŒ‡æ ‡ã€‚"""
        plot_results(file=self.csv, on_plot=self.on_plot)  # ä¿å­˜ç»“æœå›¾
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **DetectionTrainerç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒYOLOæ£€æµ‹æ¨¡å‹çš„ç±»ï¼Œç»§æ‰¿è‡ªBaseTrainerç±»ã€‚
2. **build_datasetæ–¹æ³•**ï¼šæ„å»ºYOLOæ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ã€‚
3. **get_dataloaderæ–¹æ³•**ï¼šæ„é€ æ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ã€‚
4. **preprocess_batchæ–¹æ³•**ï¼šå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¤šå°ºåº¦è°ƒæ•´ã€‚
5. **set_model_attributesæ–¹æ³•**ï¼šè®¾ç½®æ¨¡å‹çš„ç±»åˆ«æ•°é‡å’Œåç§°ã€‚
6. **get_modelæ–¹æ³•**ï¼šè¿”å›ä¸€ä¸ªYOLOæ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
7. **get_validatoræ–¹æ³•**ï¼šè¿”å›ç”¨äºéªŒè¯æ¨¡å‹çš„éªŒè¯å™¨ã€‚
8. **plot_training_sampleså’Œplot_metricsæ–¹æ³•**ï¼šç”¨äºå¯è§†åŒ–è®­ç»ƒæ ·æœ¬å’Œè®­ç»ƒæŒ‡æ ‡ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„è„šæœ¬ï¼Œç»§æ‰¿è‡ª `BaseTrainer` ç±»ã€‚æ–‡ä»¶ä¸­åŒ…å«äº†å¤šä¸ªæ–¹æ³•ï¼Œä¸»è¦ç”¨äºæ„å»ºæ•°æ®é›†ã€è·å–æ•°æ®åŠ è½½å™¨ã€é¢„å¤„ç†å›¾åƒã€è®¾ç½®æ¨¡å‹å±æ€§ã€è·å–æ¨¡å‹ã€éªŒè¯æ¨¡å‹ã€è®°å½•æŸå¤±ã€ç»˜åˆ¶è®­ç»ƒæ ·æœ¬å’Œç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ç­‰åŠŸèƒ½ã€‚

é¦–å…ˆï¼Œ`DetectionTrainer` ç±»é€šè¿‡ `build_dataset` æ–¹æ³•æ„å»º YOLO æ•°æ®é›†ã€‚è¯¥æ–¹æ³•æ¥æ”¶å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹é‡å¤§å°ä½œä¸ºå‚æ•°ï¼Œåˆ©ç”¨ `build_yolo_dataset` å‡½æ•°ç”Ÿæˆæ•°æ®é›†ã€‚æ¨¡å¼å‚æ•°å…è®¸ç”¨æˆ·ä¸ºè®­ç»ƒå’ŒéªŒè¯é˜¶æ®µè‡ªå®šä¹‰ä¸åŒçš„æ•°æ®å¢å¼ºç­–ç•¥ã€‚

æ¥ç€ï¼Œ`get_dataloader` æ–¹æ³•ç”¨äºæ„å»ºå’Œè¿”å›æ•°æ®åŠ è½½å™¨ã€‚è¯¥æ–¹æ³•ç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒæ—¶åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ï¼Œå¹¶æ ¹æ®æ¨¡å¼é€‰æ‹©æ˜¯å¦æ‰“ä¹±æ•°æ®ã€‚å®ƒè¿˜ä¼šæ ¹æ®æ¨¡å¼è®¾ç½®å·¥ä½œçº¿ç¨‹çš„æ•°é‡ï¼Œå¹¶è°ƒç”¨ `build_dataloader` å‡½æ•°ç”Ÿæˆæ•°æ®åŠ è½½å™¨ã€‚

åœ¨å›¾åƒé¢„å¤„ç†æ–¹é¢ï¼Œ`preprocess_batch` æ–¹æ³•è´Ÿè´£å¯¹å›¾åƒè¿›è¡Œç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°æ ¼å¼ã€‚è¯¥æ–¹æ³•è¿˜æ”¯æŒå¤šå°ºåº¦è®­ç»ƒï¼Œé€šè¿‡éšæœºé€‰æ‹©å›¾åƒå¤§å°å¹¶è°ƒæ•´å›¾åƒçš„å°ºå¯¸æ¥å®ç°ã€‚

`set_model_attributes` æ–¹æ³•ç”¨äºè®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ç­‰ã€‚å®ƒå°†æ•°æ®é›†ä¸­çš„ç±»åˆ«ä¿¡æ¯é™„åŠ åˆ°æ¨¡å‹ä¸Šï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤Ÿæ­£ç¡®å¤„ç†ä¸åŒçš„ç±»åˆ«ã€‚

`get_model` æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ª `DetectionModel` å®ä¾‹ï¼Œå¹¶æ ¹æ®æ•°æ®é›†çš„ç±»åˆ«æ•°é‡è¿›è¡Œåˆå§‹åŒ–ã€‚

`get_validator` æ–¹æ³•è¿”å›ä¸€ä¸ªç”¨äºéªŒè¯ YOLO æ¨¡å‹çš„éªŒè¯å™¨ï¼ŒåŒ…å«æŸå¤±åç§°ä»¥ä¾¿åç»­çš„è®­ç»ƒç›‘æ§ã€‚

`label_loss_items` æ–¹æ³•ç”¨äºè¿”å›å¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæŸå¤±é¡¹å­—å…¸ï¼Œæ–¹ä¾¿è®°å½•å’Œç›‘æ§è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±å˜åŒ–ã€‚

`progress_string` æ–¹æ³•è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„ epochã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®ä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ç­‰ä¿¡æ¯ã€‚

`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œç”ŸæˆåŒ…å«å›¾åƒå’Œå¯¹åº”è¾¹ç•Œæ¡†çš„å¯è§†åŒ–æ–‡ä»¶ï¼Œä¾¿äºæ£€æŸ¥è®­ç»ƒæ•°æ®çš„è´¨é‡ã€‚

æœ€åï¼Œ`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•åˆ†åˆ«ç”¨äºç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­è®°å½•çš„æŒ‡æ ‡å’Œåˆ›å»ºå¸¦æ ‡ç­¾çš„è®­ç»ƒå›¾ï¼Œä»¥ä¾¿åˆ†ææ¨¡å‹çš„è®­ç»ƒæ•ˆæœå’Œæ€§èƒ½ã€‚

æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„è®­ç»ƒæµç¨‹ï¼Œæ¶µç›–äº†æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºã€è®­ç»ƒç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ï¼Œæ—¨åœ¨ä¸º YOLO æ¨¡å‹çš„è®­ç»ƒæä¾›ä¾¿åˆ©ã€‚

#### 11.6 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\hub\session.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import signal
import sys
from pathlib import Path
from time import sleep
import requests
from ultralytics.hub.utils import HUB_API_ROOT, HUB_WEB_ROOT, smart_request
from ultralytics.utils import LOGGER, __version__, checks, is_colab
from ultralytics.utils.errors import HUBModelError

AGENT_NAME = f'python-{__version__}-colab' if is_colab() else f'python-{__version__}-local'

class HUBTrainingSession:
    """
    HUBè®­ç»ƒä¼šè¯ï¼Œç”¨äºUltralytics HUB YOLOæ¨¡å‹ã€‚å¤„ç†æ¨¡å‹åˆå§‹åŒ–ã€å¿ƒè·³å’Œæ£€æŸ¥ç‚¹ä¸Šä¼ ã€‚
    """

    def __init__(self, url):
        """
        ä½¿ç”¨æä¾›çš„æ¨¡å‹æ ‡è¯†ç¬¦åˆå§‹åŒ–HUBTrainingSessionã€‚

        å‚æ•°:
            url (str): ç”¨äºåˆå§‹åŒ–HUBè®­ç»ƒä¼šè¯çš„æ¨¡å‹æ ‡è¯†ç¬¦ã€‚

        å¼‚å¸¸:
            ValueError: å¦‚æœæä¾›çš„æ¨¡å‹æ ‡è¯†ç¬¦æ— æ•ˆã€‚
            ConnectionError: å¦‚æœè¿æ¥å…¨å±€APIå¯†é’¥ä¸è¢«æ”¯æŒã€‚
        """
        from ultralytics.hub.auth import Auth

        # è§£æè¾“å…¥çš„æ¨¡å‹URL
        if url.startswith(f'{HUB_WEB_ROOT}/models/'):
            url = url.split(f'{HUB_WEB_ROOT}/models/')[-1]
        if [len(x) for x in url.split('_')] == [42, 20]:
            key, model_id = url.split('_')
        elif len(url) == 20:
            key, model_id = '', url
        else:
            raise HUBModelError(f"model='{url}' not found. Check format is correct.")

        # æˆæƒ
        auth = Auth(key)
        self.agent_id = None  # æ ‡è¯†ä¸æœåŠ¡å™¨é€šä¿¡çš„å®ä¾‹
        self.model_id = model_id
        self.model_url = f'{HUB_WEB_ROOT}/models/{model_id}'
        self.api_url = f'{HUB_API_ROOT}/v1/models/{model_id}'
        self.auth_header = auth.get_auth_header()
        self.rate_limits = {'metrics': 3.0, 'ckpt': 900.0, 'heartbeat': 300.0}  # APIè°ƒç”¨çš„é€Ÿç‡é™åˆ¶ï¼ˆç§’ï¼‰
        self.metrics_queue = {}  # æ¨¡å‹çš„æŒ‡æ ‡é˜Ÿåˆ—
        self.model = self._get_model()  # è·å–æ¨¡å‹æ•°æ®
        self.alive = True  # å¿ƒè·³å¾ªç¯æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€
        self._start_heartbeat()  # å¯åŠ¨å¿ƒè·³
        self._register_signal_handlers()  # æ³¨å†Œä¿¡å·å¤„ç†å™¨
        LOGGER.info(f'æŸ¥çœ‹æ¨¡å‹: {self.model_url} ğŸš€')

    def _get_model(self):
        """ä»Ultralytics HUBè·å–å¹¶è¿”å›æ¨¡å‹æ•°æ®ã€‚"""
        api_url = f'{HUB_API_ROOT}/v1/models/{self.model_id}'

        try:
            response = smart_request('get', api_url, headers=self.auth_header, thread=False, code=0)
            data = response.json().get('data', None)

            if data.get('status', None) == 'trained':
                raise ValueError('æ¨¡å‹å·²è®­ç»ƒå¹¶ä¸Šä¼ ã€‚')

            if not data.get('data', None):
                raise ValueError('æ•°æ®é›†å¯èƒ½ä»åœ¨å¤„ç†ã€‚è¯·ç¨ç­‰ç‰‡åˆ»å†è¯•ã€‚')

            self.model_id = data['id']  # æ›´æ–°æ¨¡å‹ID

            # æ ¹æ®æ¨¡å‹çŠ¶æ€è®¾ç½®è®­ç»ƒå‚æ•°
            if data['status'] == 'new':
                self.train_args = {
                    'batch': data['batch_size'],
                    'epochs': data['epochs'],
                    'imgsz': data['imgsz'],
                    'patience': data['patience'],
                    'device': data['device'],
                    'cache': data['cache'],
                    'data': data['data']}
                self.model_file = data.get('cfg') or data.get('weights')
                self.model_file = checks.check_yolov5u_filename(self.model_file, verbose=False)
            elif data['status'] == 'training':
                self.train_args = {'data': data['data'], 'resume': True}
                self.model_file = data['resume']

            return data
        except requests.exceptions.ConnectionError as e:
            raise ConnectionRefusedError('é”™è¯¯: HUBæœåŠ¡å™¨æœªåœ¨çº¿ã€‚è¯·ç¨åå†è¯•ã€‚') from e
        except Exception:
            raise

    @threaded
    def _start_heartbeat(self):
        """å¼€å§‹ä¸€ä¸ªçº¿ç¨‹å¿ƒè·³å¾ªç¯ï¼Œå‘Ultralytics HUBæŠ¥å‘Šä»£ç†çš„çŠ¶æ€ã€‚"""
        while self.alive:
            r = smart_request('post',
                              f'{HUB_API_ROOT}/v1/agent/heartbeat/models/{self.model_id}',
                              json={'agent': AGENT_NAME, 'agentId': self.agent_id},
                              headers=self.auth_header,
                              retry=0,
                              code=5,
                              thread=False)  # å·²åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­
            self.agent_id = r.json().get('data', {}).get('agentId', None)  # æ›´æ–°ä»£ç†ID
            sleep(self.rate_limits['heartbeat'])  # æ ¹æ®é€Ÿç‡é™åˆ¶ä¼‘çœ 
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **HUBTrainingSessionç±»**ï¼šè¯¥ç±»ç”¨äºç®¡ç†ä¸Ultralytics HUBçš„è®­ç»ƒä¼šè¯ï¼ŒåŒ…æ‹¬æ¨¡å‹çš„åˆå§‹åŒ–ã€å¿ƒè·³æœºåˆ¶å’ŒæŒ‡æ ‡ä¸Šä¼ ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼šåœ¨åˆå§‹åŒ–æ—¶ï¼Œè§£ææ¨¡å‹çš„URLï¼Œè¿›è¡Œæˆæƒï¼Œè®¾ç½®æ¨¡å‹çš„ç›¸å…³å‚æ•°ï¼Œå¹¶å¯åŠ¨å¿ƒè·³æœºåˆ¶ã€‚
3. **_get_modelæ–¹æ³•**ï¼šä»Ultralytics HUBè·å–æ¨¡å‹æ•°æ®ï¼Œå¹¶æ ¹æ®æ¨¡å‹çš„çŠ¶æ€è®¾ç½®è®­ç»ƒå‚æ•°ã€‚
4. **_start_heartbeatæ–¹æ³•**ï¼šåœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­å®šæœŸå‘Ultralytics HUBå‘é€å¿ƒè·³è¯·æ±‚ï¼Œä»¥ä¿æŒä¼šè¯çš„æ´»è·ƒçŠ¶æ€ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯Ultralytics YOLOæ¨¡å‹çš„ä¸€ä¸ªè®­ç»ƒä¼šè¯ç®¡ç†ç±»ï¼Œåä¸º`HUBTrainingSession`ï¼Œç”¨äºå¤„ç†æ¨¡å‹çš„åˆå§‹åŒ–ã€å¿ƒè·³ç›‘æµ‹å’Œæ£€æŸ¥ç‚¹ä¸Šä¼ ç­‰åŠŸèƒ½ã€‚é¦–å…ˆï¼Œç¨‹åºå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬ä¿¡å·å¤„ç†ã€ç³»ç»Ÿæ“ä½œã€è·¯å¾„å¤„ç†ã€æ—¶é—´æ§åˆ¶å’ŒHTTPè¯·æ±‚ç­‰ã€‚æ¥ç€ï¼Œå®šä¹‰äº†ä¸€ä¸ªå…¨å±€å˜é‡`AGENT_NAME`ï¼Œç”¨äºæ ‡è¯†å½“å‰çš„Pythonç¯å¢ƒï¼ˆæœ¬åœ°æˆ–Colabï¼‰ã€‚

åœ¨`HUBTrainingSession`ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œæ¥å—ä¸€ä¸ªæ¨¡å‹æ ‡è¯†ç¬¦`url`ï¼Œå¹¶è§£æè¯¥æ ‡è¯†ç¬¦ä»¥è·å–æ¨¡å‹çš„å…³é”®éƒ¨åˆ†ã€‚æ ¹æ®è¾“å…¥çš„æ ¼å¼ï¼Œç¨‹åºä¼šå°†å…¶è½¬æ¢ä¸ºç›¸åº”çš„æ¨¡å‹IDå’ŒAPIå¯†é’¥ã€‚å¦‚æœè¾“å…¥çš„æ ¼å¼ä¸æ­£ç¡®ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªè‡ªå®šä¹‰çš„`HUBModelError`å¼‚å¸¸ã€‚éšåï¼Œç¨‹åºä¼šè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶åˆå§‹åŒ–ä¸€äº›é‡è¦çš„å±æ€§ï¼Œä¾‹å¦‚æ¨¡å‹çš„URLã€API URLã€èº«ä»½éªŒè¯å¤´ã€é€Ÿç‡é™åˆ¶å’Œæ¨¡å‹æ•°æ®ç­‰ã€‚æœ€åï¼Œå¯åŠ¨å¿ƒè·³ç›‘æµ‹å’Œä¿¡å·å¤„ç†ç¨‹åºï¼Œå¹¶è®°å½•æ¨¡å‹çš„è®¿é—®ä¿¡æ¯ã€‚

ç±»ä¸­æœ‰å¤šä¸ªæ–¹æ³•ï¼Œé¦–å…ˆæ˜¯`_register_signal_handlers`ï¼Œç”¨äºæ³¨å†Œä¿¡å·å¤„ç†ç¨‹åºï¼Œä»¥ä¾¿åœ¨æ¥æ”¶åˆ°ç»ˆæ­¢ä¿¡å·æ—¶èƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†ç¨‹åºçš„ç»“æŸã€‚`_handle_signal`æ–¹æ³•åˆ™æ˜¯å…·ä½“å¤„ç†æ¥æ”¶åˆ°çš„ä¿¡å·ï¼Œåœæ­¢å¿ƒè·³å¹¶é€€å‡ºç¨‹åºã€‚`_stop_heartbeat`æ–¹æ³•ç”¨äºç»ˆæ­¢å¿ƒè·³å¾ªç¯ã€‚

`upload_metrics`æ–¹æ³•ç”¨äºå°†æ¨¡å‹çš„æ€§èƒ½æŒ‡æ ‡ä¸Šä¼ åˆ°Ultralytics HUBã€‚`_get_model`æ–¹æ³•åˆ™è´Ÿè´£ä»Ultralytics HUBè·å–æ¨¡å‹æ•°æ®ï¼Œå¤„ç†æ¨¡å‹çš„çŠ¶æ€ï¼Œå¹¶æ ¹æ®çŠ¶æ€å†³å®šæ˜¯å¼€å§‹æ–°çš„è®­ç»ƒè¿˜æ˜¯æ¢å¤å·²æœ‰çš„è®­ç»ƒã€‚è¿™ä¸ªæ–¹æ³•è¿˜ä¼šå¤„ç†è¿æ¥é”™è¯¯ç­‰å¼‚å¸¸æƒ…å†µã€‚

`upload_model`æ–¹æ³•ç”¨äºå°†æ¨¡å‹çš„æ£€æŸ¥ç‚¹ä¸Šä¼ åˆ°Ultralytics HUBï¼Œæ”¯æŒä¸Šä¼ å½“å‰è®­ç»ƒçš„æƒé‡æ–‡ä»¶ï¼Œå¹¶æ ‡è®°è¯¥æ¨¡å‹æ˜¯å¦æ˜¯æœ€ä½³æ¨¡å‹æˆ–æœ€ç»ˆæ¨¡å‹ã€‚è¯¥æ–¹æ³•æ ¹æ®ä¸Šä¼ çš„æ¨¡å‹çŠ¶æ€é€‰æ‹©åˆé€‚çš„ä¸Šä¼ æ–¹å¼ã€‚

æœ€åï¼Œ`_start_heartbeat`æ–¹æ³•ä»¥çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ä¸€ä¸ªå¿ƒè·³å¾ªç¯ï¼Œå®šæœŸå‘Ultralytics HUBæŠ¥å‘Šä»£ç†çš„çŠ¶æ€ã€‚è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ç¨‹åºè¿è¡Œæ—¶æŒç»­å‘é€å¿ƒè·³è¯·æ±‚ï¼Œç¡®ä¿ä¸æœåŠ¡å™¨çš„è¿æ¥ä¿æŒæ´»è·ƒã€‚

æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶å®ç°äº†YOLOæ¨¡å‹åœ¨Ultralytics HUBä¸Šçš„è®­ç»ƒä¼šè¯ç®¡ç†ï¼Œæ¶µç›–äº†æ¨¡å‹çš„åˆå§‹åŒ–ã€çŠ¶æ€ç›‘æµ‹å’Œæ€§èƒ½æŒ‡æ ‡ä¸Šä¼ ç­‰åŠŸèƒ½ï¼Œç¡®ä¿è®­ç»ƒè¿‡ç¨‹çš„é¡ºåˆ©è¿›è¡Œã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºYOLOv8çš„ç›®æ ‡æ£€æµ‹æ¡†æ¶ï¼Œæä¾›äº†å¤šç§ç®—æ³•æ”¹è¿›å’Œè®­ç»ƒè°ƒè¯•å·¥å…·ã€‚å…¶æ•´ä½“åŠŸèƒ½åŒ…æ‹¬æ¨¡å‹çš„å®šä¹‰ã€è®­ç»ƒã€éªŒè¯ã€å¯è§†åŒ–ã€ä¼šè¯ç®¡ç†å’Œæ•°æ®å¤„ç†ç­‰ã€‚é¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œå„ä¸ªæ¨¡å—åŠŸèƒ½åˆ†æ˜ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œæ¨¡å‹è®­ç»ƒã€ç»“æœå¯è§†åŒ–å’Œæ¨¡å‹æ€§èƒ½ç›‘æ§ã€‚

- **æ¨¡å‹å®šä¹‰**ï¼šæä¾›äº†YOLOv8åŠå…¶å˜ç§ï¼ˆå¦‚YOLO-NASï¼‰çš„å®ç°ï¼Œæ”¯æŒè‡ªå®šä¹‰æ¨¡å‹ç»“æ„ã€‚
- **è®­ç»ƒä¸éªŒè¯**ï¼šåŒ…å«è®­ç»ƒå’ŒéªŒè¯çš„å®Œæ•´æµç¨‹ï¼Œæ”¯æŒæ•°æ®é›†çš„æ„å»ºå’Œæ•°æ®åŠ è½½ã€‚
- **å¯è§†åŒ–å·¥å…·**ï¼šæä¾›äº†å¯è§†åŒ–å·¥å…·ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£æ¨¡å‹çš„é¢„æµ‹ç»“æœå’Œè®­ç»ƒè¿‡ç¨‹ã€‚
- **ä¼šè¯ç®¡ç†**ï¼šé€šè¿‡`HUBTrainingSession`ç±»ç®¡ç†è®­ç»ƒä¼šè¯ï¼Œæ”¯æŒä¸Ultralytics HUBçš„äº¤äº’ã€‚
- **æ•°æ®å¤„ç†**ï¼šå®ç°äº†æ•°æ®é¢„å¤„ç†å’Œå¢å¼ºåŠŸèƒ½ï¼Œç¡®ä¿è®­ç»ƒæ•°æ®çš„è´¨é‡ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                                          | åŠŸèƒ½æè¿°                                                       |
|---------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
| `ultralytics/nn/extra_modules/ops_dcnv3/modules/__init__.py`                                   | åˆå§‹åŒ–DCNv3æ¨¡å—ï¼Œå¯¼å…¥ç›¸å…³ç±»å’Œå‡½æ•°ã€‚                           |
| `ultralytics/utils/plotting.py`                                                                  | æä¾›å¯è§†åŒ–å·¥å…·ï¼Œç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬ã€æŸå¤±æ›²çº¿å’Œæ¨¡å‹é¢„æµ‹ç»“æœã€‚     |
| `ui.py`                                                                                          | è¿è¡ŒæŒ‡å®šçš„Pythonè„šæœ¬ï¼ˆå¦‚`web.py`ï¼‰ï¼Œç”¨äºå¯åŠ¨ç”¨æˆ·ç•Œé¢ã€‚         |
| `ultralytics/models/nas/model.py`                                                                | å®šä¹‰YOLO-NASæ¨¡å‹çš„æ¥å£ï¼Œæ”¯æŒæ¨¡å‹åŠ è½½å’Œä¿¡æ¯è·å–ã€‚               |
| `train.py`                                                                                       | å®ç°YOLOæ¨¡å‹çš„è®­ç»ƒæµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é›†æ„å»ºã€æ¨¡å‹è®­ç»ƒå’Œç»“æœç›‘æ§ã€‚   |
| `ultralytics/hub/session.py`                                                                     | ç®¡ç†ä¸Ultralytics HUBçš„è®­ç»ƒä¼šè¯ï¼ŒåŒ…æ‹¬å¿ƒè·³ç›‘æµ‹å’Œæ¨¡å‹ä¸Šä¼ ã€‚       |
| `ultralytics/data/explorer/explorer.py`                                                          | æä¾›æ•°æ®é›†æ¢ç´¢å·¥å…·ï¼Œæ–¹ä¾¿ç”¨æˆ·æŸ¥çœ‹å’Œåˆ†ææ•°æ®é›†ã€‚                 |
| `ultralytics/trackers/utils/kalman_filter.py`                                                   | å®ç°å¡å°”æ›¼æ»¤æ³¢å™¨ï¼Œç”¨äºç›®æ ‡è·Ÿè¸ªå’ŒçŠ¶æ€ä¼°è®¡ã€‚                     |
| `ultralytics/models/yolo/detect/predict.py`                                                     | å®ç°YOLOæ¨¡å‹çš„é¢„æµ‹åŠŸèƒ½ï¼Œå¤„ç†è¾“å…¥å›¾åƒå¹¶è¿”å›æ£€æµ‹ç»“æœã€‚           |
| `ultralytics/cfg/__init__.py`                                                                    | åˆå§‹åŒ–é…ç½®æ¨¡å—ï¼ŒåŠ è½½æ¨¡å‹å’Œè®­ç»ƒå‚æ•°ã€‚                           |
| `ultralytics/models/yolo/segment/train.py`                                                      | å®ç°YOLOæ¨¡å‹çš„åˆ†å‰²è®­ç»ƒæµç¨‹ï¼Œæ”¯æŒå›¾åƒåˆ†å‰²ä»»åŠ¡ã€‚                 |
| `ultralytics/models/yolo/classify/train.py`                                                     | å®ç°YOLOæ¨¡å‹çš„åˆ†ç±»è®­ç»ƒæµç¨‹ï¼Œæ”¯æŒå›¾åƒåˆ†ç±»ä»»åŠ¡ã€‚                 |
| `ultralytics/nn/extra_modules/head.py`                                                          | å®šä¹‰æ¨¡å‹çš„å¤´éƒ¨ç»“æ„ï¼Œå¤„ç†æ¨¡å‹çš„è¾“å‡ºå±‚ã€‚                         |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†é¡¹ç›®ä¸­å„ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œä¾¿äºç”¨æˆ·å¿«é€Ÿäº†è§£é¡¹ç›®çš„ç»“æ„å’ŒåŠŸèƒ½æ¨¡å—ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šD:\tools\20240905\Temporary](D:\tools\20240905\Temporary)